---
- name: Create docker container and expose namespace
  hosts: localhost
  become: true
  vars:
    container_name: c2
    image_name: ubuntuImage
  tasks:
    - name: Create Docker container
      command: sudo docker run --net=none --name {{ container_name }} -it {{image_name}}
   
    - name: Get container PID
      shell: docker inspect {{ container_name }} | grep '"Pid"' | awk '{ print $2 }' | sed 's/,.*//'
      register: container_pid

    - name: Create net namespace
      shell: ln -sf /proc/{{ container_pid.stdout }}/ns/net /var/run/netns/{{ container_name }}
      
    - name: Create net namespace
      shell: docker exec {{ container_name }} service ssh start
      
    
